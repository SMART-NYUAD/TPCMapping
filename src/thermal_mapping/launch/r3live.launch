<?xml version="1.0"?>
<launch>
<!-- Testing r3live-->
    <arg name="launch_rviz" default="true"/>
    <arg name="file_rviz" default="r3live"/>

    <arg name="gazebo_world" default="$(find thermal_mapping)/worlds/testing.world"/>
	<arg name="default_xacro" default="summit_xl_std.urdf.xacro"/>

	<!-- arguments robot a -->
	<arg name="id_robot_a" default="robot"/>
	<arg name="launch_robot_a" default="true"/>
	<arg name="xacro_robot_a" default="$(arg default_xacro)"/>

    <include file="$(find summit_xl_gazebo)/launch/summit_xl_gazebo.launch">
        <arg name="launch_rviz" value="false"/>
        <arg name="gazebo_world" value="$(arg gazebo_world)"/>
        <!-- general args -->
        <arg name="default_xacro" value="$(arg default_xacro)"/>
		<!-- robot_a args -->
		<arg name="id_robot_a" value="$(arg id_robot_a)"/>
		<arg name="launch_robot_a" value="$(arg launch_robot_a)"/>
		<arg name="xacro_robot_a" value="$(arg xacro_robot_a)"/>
    </include>

    <node if="$(arg launch_rviz)" name="rviz" pkg="rviz" type="rviz" required="true" args="-d $(find thermal_mapping)/rviz/$(arg file_rviz).rviz"/>

    <!-- R3live -->
    <remap from="/os_cloud_node/points" to="/robot/ouster/points"/>
    <param name="/LiDAR_pointcloud_topic" type="string" value= "/laser_cloud_flat" />
    <param name="/IMU_topic" type="string" value= "/robot/imu/data_raw" />
    <!-- <param name="/Image_topic" type="string" value= "/NotAvail" /> -->
    <param name="Image_topic" type="string" value= "/robot/robot_front_ptz_camera/image_raw"/>
    <!-- <param name="Image_topic" type="string" value="/robot/front_rgbd_camera/rgb/image_raw"/> -->
    <param name="map_output_dir" type="string" value="$(env HOME)/r3live_output" />
    <rosparam command="load" file="$(find r3live)/../config/r3live_config.yaml" />
    
    <!-- set LiDAR type as ouster-64 spining LiDAR -->
    <param name="/Lidar_front_end/lidar_type" type="int" value= "3" /> 
    <param name="/Lidar_front_end/point_step" type="int" value="1" />
    <param name="r3live_lio/lio_update_point_step" type="int" value="6" />
        
    <node pkg="r3live" type="r3live_LiDAR_front_end" name="r3live_LiDAR_front_end"  output="log" required="true"/>
    <node pkg="r3live" type="r3live_mapping" name="r3live_mapping" output="log" required="true" />
    
    <!-- <arg name="rviz" default="1" />
    <group if="$(arg rviz)">
        <node name="rvizvisualisation" pkg="rviz" type="rviz" output="log" args="-d $(find r3live)/../config/rviz/r3live_rviz_config_ouster.rviz" />
    </group> -->

</launch>